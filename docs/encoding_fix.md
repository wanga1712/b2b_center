# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –≤—ã–≤–æ–¥–∞ subprocess

## üìã –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —á–µ—Ä–µ–∑ `subprocess.run()` –Ω–∞ Windows –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –≤—ã–≤–æ–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞:

```
File "C:\Users\wangr\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
File "C:\Users\wangr\AppData\Local\Programs\Python\Python311\Lib\subprocess.py", line 1599, in _readerthread
    buffer.append(fh.read())
File "C:\Users\wangr\AppData\Local\Programs\Python\Python311\Lib\encodings\cp1251.py", line 23, in decode
    return codecs.charmap_decode(input,self.errors,decoding_table)[0]
```

### –ü—Ä–∏—á–∏–Ω–∞

–ù–∞ Windows Python –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–¥–∏—Ä–æ–≤–∫—É `cp1251` (Windows-1251) –¥–ª—è —á—Ç–µ–Ω–∏—è –≤—ã–≤–æ–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ö–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–≤–æ–¥–∏—Ç —Å–∏–º–≤–æ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤—Ö–æ–¥—è—Ç –≤ —ç—Ç—É –∫–æ–¥–∏—Ä–æ–≤–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, UTF-8 —Å–∏–º–≤–æ–ª—ã –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã), –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ —è–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –≤–æ –≤—Å–µ –≤—ã–∑–æ–≤—ã `subprocess.run()`:

1. **–£–∫–∞–∑–∞–Ω–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è –≤—Å–µ —Å–∏–º–≤–æ–ª—ã
2. **–î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `errors='replace'`** - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ `` –≤–º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

#### 1. `services/document_search/archive_extractor.py`

**–ú–µ—Ç–æ–¥:** `_extract_rar_archive()`

**–ë—ã–ª–æ:**
```python
result = subprocess.run(
    command,
    cwd=str(archive_path.parent),
    capture_output=True,
    text=True,
)
```

**–°—Ç–∞–ª–æ:**
```python
result = subprocess.run(
    command,
    cwd=str(archive_path.parent),
    capture_output=True,
    text=True,
    encoding='utf-8',
    errors='replace',  # –ó–∞–º–µ–Ω—è–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏
)
```

#### 2. `services/archive_runner/tender_folder_manager.py`

**–ú–µ—Ç–æ–¥:** `_force_delete_file()`

**–ë—ã–ª–æ:**
```python
subprocess.run(
    ['powershell', '-Command', ps_command],
    capture_output=True,
    timeout=5,
    check=False
)
```

**–°—Ç–∞–ª–æ:**
```python
subprocess.run(
    ['powershell', '-Command', ps_command],
    capture_output=True,
    timeout=5,
    check=False,
    encoding='utf-8',
    errors='replace',  # –ó–∞–º–µ–Ω—è–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏
)
```

#### 3. `services/document_search/word_processor.py`

**–ú–µ—Ç–æ–¥—ã:** 
- `__init__()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ antiword
- `_extract_doc_text()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ .doc —Ñ–∞–π–ª–æ–≤

**–ë—ã–ª–æ:**
```python
result = subprocess.run(
    ['antiword', '-h'],
    capture_output=True,
    timeout=2
)
```

**–°—Ç–∞–ª–æ:**
```python
result = subprocess.run(
    ['antiword', '-h'],
    capture_output=True,
    timeout=2,
    encoding='utf-8',
    errors='replace',  # –ó–∞–º–µ–Ω—è–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏
)
```

## üîç –ü–æ—á–µ–º—É `errors='replace'`?

–ü–∞—Ä–∞–º–µ—Ç—Ä `errors='replace'` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ:
- –ü—Ä–æ—Ü–µ—Å—Å –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Å–∏–º–≤–æ–ª–∞—Ö
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –±—É–¥—É—Ç –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ ``
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:
- `errors='ignore'` - –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (–Ω–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
- `errors='strict'` - –≤—ã–∑—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–µ)

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É** –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `subprocess.run()` —Å `text=True`
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ UTF-8** –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏** —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `errors`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–∏
2. ‚úÖ –í—ã–≤–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —á–∏—Ç–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ `` –≤–º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

## üìä –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

- –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ RAR –∞—Ä—Ö–∏–≤–æ–≤ —á–µ—Ä–µ–∑ unrar
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ PowerShell –∫–æ–º–∞–Ω–¥
- –û–±—Ä–∞–±–æ—Ç–∫–∞ Word –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ antiword

–í—Å–µ —ç—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –≤—ã–≤–æ–¥ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–æ–¥–∏—Ä–æ–≤–∫–∏.

